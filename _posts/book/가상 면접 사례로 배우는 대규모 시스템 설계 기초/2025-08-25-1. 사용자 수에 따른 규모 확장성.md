---
title: "[Book - 가상 면접 사례로 배우는 대규모 시스템 설계 기초] 1. 사용자 수에 따른 규모 확장성"
date: 2025-08-26 23:00:00 +0900
categories: [Book - 가상 면접 사례로 배우는 대규모 시스템 설계 기초]
tags: [book, System Design Interview]
---

# 단일 서버
* 사용자 요청 처리 흐름
  1. 도메인명(www.google.com) 접속
  2. DNS 조회 결과로 IP 주소(172.217.25.164) 반환
  3. 해당 IP 주소로 HTTP 요청 전달
  4. 요청을 받은 웹 서버가 HTML 페이지 및 JSON 형태의 응답 반환

---
 
# 데이터베이스
사용자가 늘면 서버 하나로는 충분하지 않아서 여러 서버를 두어야 한다.   
하나는 웹/모바일 트래픽 처리 용도이고, 다른 하나는 데이터베이스용으로 분리하면 그 각각을 독립적으로 확장해 나갈 수 있게 된다.

* 데이터베이스 종류
  * RDBMS
  * NoSQL

---

# 수직적 규모 확장 vs 수평적 규모 확장
* Scale Up
  * 수직적 규모 확장
  * 서버에 고사양 자원(CPU, RAM 등)을 추가
* Scale Out
  * 수평적 규모 확장
  * 더 많은 서버를 추가하여 성능을 개선

## Scale Up
서버로 유입되는 트래픽의 양이 적을 때는 단순하므로 좋은 선택이다.

하지만, 한 대의 서버에 CPU나 메모리를 무한대로 증설할 방법이 없으므로 한계가 있다.   
또한, 장애에 대한 자동복구(failover) 방안이나 다중화(redundancy) 방안을 제시하지 않기 때문에 서버에 장애가 발생하면 웹사이트/앱은 완전히 중단된다.

위와 같은 단점 때문에 대규모 애플리케이션을 지원하는 데는 Scale Out이 보다 적절하다.

## Scale Out
웹 서버가 다운되거나 너무 많은 사용자가 접속하게 되면 응답 속도가 느려지거나 서버 접속이 불가능해질 수도 있다.   
이런 문제를 해결하는 데는 부하 분산기 또는 로드 밸런서를 도입하는 것이 최선이다.

### 로드밸런서
로드밸런서는 부하 분산 집합(load balancing set)에 속한 웹 서버들에게 트래픽 부하를 고르게 분산하는 역할을 한다.

![로드밸런서](https://drive.google.com/thumbnail?id=1sDRWU3iUW_NsG2AH3BaedI1hf1d9PDcS&sz=w300)

사용자는 로드밸런서의 공개 IP 주소로 접속하므로, 웹 서버는 클라이언트의 접속을 직접 처리하지 않고,   
더 나은 보안을 위해 서버 간 통신에는 사설 IP 주소가 이용된다.
> 사설 IP 주소는 같은 네트워크에 속한 서버 사이의 통신에만 쓰일 수 있는 IP 주소로, 인터넷을 통해서는 접속할 수 없다.

<br>

부하 분산 집합에 또 하나의 웹 서버를 추가하고 나면 장애를 자동복구하지 못하는 문제(no failover)는 해소되며, 웹 계층의 가용성(availability)는 향상된다.
1. 서버 1이 다운되면 모든 트래픽은 서버 2로 전송되어 웹 사이트 전체가 다운되는 일이 방지된다.
2. 웹 사이트로 유입되는 트래픽이 증가하면 웹 서버 계층에 더 많은 서버를 추가하여 로드밸런서로 트래픽을 분산한다.

웹 계층을 보았으니 이제 데이터 계층을 보자.

### 데이터베이스 다중화
데이터베이스를 다중화하면 아래와 같은 이점이 있다.
* 더 나은 성능
  
  master-slave 다중화 모델에서 모든 데이터 변경 연산은 master DB 서버로만 전달되는 반면 읽기 연산은 slave DB 서버들로 분산된다.   
  병렬로 처리될 수 있는 query의 수가 늘어나므로, 성능이 좋아진다.

* 안정성(reliability)

  DB 서버 가운데 일부가 파괴되어도 데이터를 지역적으로 떨어진 여러 장소에 다중화시켜 놓았기 때문에 데이터는 보존될 것이다.

* 가용성(availability)

  데이터를 여러 지역에 복제해 둠으로써, 하나의 DB 서버에 장애가 발생하더라도 다른 서버에 있는 데이터를 가져와 계속 서비스할 수 있게 된다.

### 로드밸런서 + 데이터베이스 다중화
로드밸런서와 데이터베이스 다중화를 고려하여 설계하면 아래와 같이 동작한다.

1. 사용자는 DNS로부터 로드밸런서의 public IP 주소를 받는다.
2. 사용자는 해당 IP 주소를 사용해 로드밸런서에 접속한다.
3. HTTP 요청은 서버A나 서버B로 전달된다.
4. 웹 서버는 사용자의 데이터를 slave DB 서버에서 읽는다.
5. 웹 서버는 데이터 변경 연산을 master DB로 전달한다.(insert, update, delete 연산 등이 해당)

웹 계층과 데이터 계층에 대해 알아봤다.   
이제 응답시간(latency)을 개선해 보자.   
latency는 cache를 붙이고 정적 콘텐츠를 콘텐츠 전송 네트워크(CDN)로 옮기면 개선할 수 있다.

---

# 캐시

